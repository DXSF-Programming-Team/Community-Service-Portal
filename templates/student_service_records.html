{% extends 'student_portal_base.html' %}
{% block title %}Service Records{% endblock %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="https://cdn.datatables.net/2.3.4/css/dataTables.dataTables.css" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/2.3.4/js/dataTables.js"></script>
{% endblock %}
{% block styles %}
    <style>
        .service-records-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
        }
        .contents-container {
            max-width: 90%;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .page-title {
            margin-top: 2rem;
        }
        .btn-view {
            background-color: #002d5b;
            border: none;
            color: white;
            padding: 10px 15px;
            margin-bottom: 10px;
        }
        .btn-view:hover {
            background-color: #0056b3;
            color: white;
            cursor: pointer;
        }
    </style>
{% endblock %}
{% block content %}
<div class="contents-container">
    {% if view == 'all' %}
        <h1 class="text-center header-text page-title">All Service Records</h1>
        <p>Below are <strong>all</strong> of your service records. You currently have {{ service_records|length }} service {% if service_records|length == 1 %}record{% else %}records{% endif %}. You have a total of {{ student.in_school_hours + student.out_of_school_hours }} {% if student.in_school_hours + student.out_of_school_hours == 1 %}hour{% else %}hours{% endif %} logged.</p>
        <div class="button-group">
            <a href="/student_portal/service_records?view=in_school" class="btn btn-view">View Your In-School Service Records</a>
            <a href="/student_portal/service_records?view=out_school" class="btn btn-view">View Your Out-of-School Service Records</a>
        </div>
    {% elif view == 'in_school' %}
        <h1 class="text-center header-text page-title">In-School Service Records</h1>
        <p>Below are all of your <strong>in-school</strong> service records. You currently have {{ service_records | selectattr('is_in_school', 'equalto', True) | list | length }} in-school service {% if (service_records | selectattr('is_in_school', 'equalto', True) | list | length) == 1 %}record{% else %}records{% endif %}. You have a total of {{ student.in_school_hours }} in-school {% if student.in_school_hours == 1 %}hour{% else %}hours{% endif %} logged.</p>
        <div class="button-group">
            <a href="/student_portal/service_records?view=all" class="btn btn-view">View All Service Records</a>
            <a href="/student_portal/service_records?view=out_school" class="btn btn-view">View Your Out-of-School Service Records</a>
        </div>
    {% elif view == 'out_school' %}
        <h1 class="text-center header-text page-title">Out-of-School Service Records</h1>
        <p>Below are all of your <strong>out-of-school</strong> service records. You currently have {{ service_records | selectattr('is_in_school', 'equalto', False) | list | length }} out-of-school service {% if (service_records | selectattr('is_in_school', 'equalto', False) | list | length) == 1 %}record{% else %}records{% endif %}. You have a total of {{ student.out_of_school_hours }} out-of-school {% if student.out_of_school_hours == 1 %}hour{% else %}hours{% endif %} logged.</p>
        <div class="button-group">
            <a href="/student_portal/service_records?view=all" class="btn btn-view">View All Service Records</a>
            <a href="/student_portal/service_records?view=in_school" class="btn btn-view">View Your In-School Service Records</a>
        </div>
    {% endif %}
    <div class="service-records-container">
        <table class="table table-striped table-bordered service-records-table" id="service_records_table">
            <thead>
                <tr>
                    <th>Date(s)</th>
                    <th>Organization</th>
                    <th>Event</th>
                    <th>Contact</th>
                    <th>Contact Email</th>
                    <th>Hours</th>
                    <th>Description</th>
                    <th>Proof of Service</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for service_record in service_records %}
                    {% if service_record.is_in_school == True and view == 'in_school' %}
                    <tr>
                        <td>{% for date in service_record.dates %}{{ date }}{% if not loop.last %}, {% endif %}{% endfor %}</td>
                        <td>{{ service_record.organization_name }}</td>
                        <td>{{ service_record.event_name }}</td>
                        <td>{{ service_record.contact_name }}</td>
                        <td>{{ service_record.contact_email }}</td>
                        <td>{{ service_record.hours }}</td>
                        <td>{{ service_record.description }}</td>
                        <td>{{ service_record.proof_of_service }}</td>
                        <td>{{ service_record.status }}</td>
                    </tr>
                {% elif service_record.is_in_school == False and view == 'out_school' %}
                    <tr>
                        <td>{% for date in service_record.dates %}{{ date }}{% if not loop.last %}, {% endif %}{% endfor %}</td>
                        <td>{{ service_record.organization_name }}</td>
                        <td>{{ service_record.event_name }}</td>
                        <td>{{ service_record.contact_name }}</td>
                        <td>{{ service_record.contact_email }}</td>
                        <td>{{ service_record.hours }}</td>
                        <td>{{ service_record.description }}</td>
                        <td>{{ service_record.proof_of_service }}</td>
                        <td>{{ service_record.status }}</td>
                    </tr>
                {% elif view == 'all' %}
                    <tr>
                        <td>{% for date in service_record.dates %}{{ date }}{% if not loop.last %}, {% endif %}{% endfor %}</td>
                        <td>{{ service_record.organization_name }}</td>
                        <td>{{ service_record.event_name }}</td>
                        <td>{{ service_record.contact_name }}</td>
                        <td>{{ service_record.contact_email }}</td>
                        <td>{{ service_record.hours }}</td>
                        <td>{{ service_record.description }}</td>
                        <td>{{ service_record.proof_of_service }}</td>
                        <td>{{ service_record.status }}</td>
                    </tr>
                {% endif %}
                {% endfor %}
            </tbody>
            </table>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
    $(document).ready(function() {
        $('#service_records_table').DataTable();
    });
</script>
{% endblock %}